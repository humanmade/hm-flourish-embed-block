(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.React,r=window.wp.blocks,n=window.wp.blockEditor,o=window.wp.components,l=window.wp.apiFetch;var a=e.n(l);const s=window.wp.element,i=window.wp.url;function d({block:e,attributes:r={},messages:n={}}){const l={emptyResponse:"No content to display",error:"Error",...n},[d,c]=(0,s.useState)(""),[u,p]=(0,s.useState)(!0),[m,b]=(0,s.useState)(null);return(0,s.useEffect)(()=>{p(!0),b(null);const t=(0,i.addQueryArgs)(`/wp/v2/block-renderer/${e}`,{context:"edit",sandboxedPreview:"1"});a()({path:t,method:"POST",data:{attributes:r}}).then(e=>{c(e.rendered||""),p(!1)}).catch(e=>{b(e.message||"Unknown error"),p(!1)})},[e,JSON.stringify(r)]),u?(0,t.createElement)("div",{style:{textAlign:"center",padding:"2em"}},(0,t.createElement)(o.Spinner,null)):m?(0,t.createElement)("div",{style:{padding:"1em",border:"1px solid #dc3232",backgroundColor:"#fef7f7"}},(0,t.createElement)("strong",null,l.error,":")," ",m):d?(0,t.createElement)(o.SandBox,{html:d}):(0,t.createElement)("div",{style:{padding:"1em",border:"1px solid #ddd",backgroundColor:"#f9f9f9"}},l.emptyResponse)}(0,r.registerBlockType)("hm/flourish-embed",{title:"Flourish Embed",description:"Embed Flourish data visualizations",category:"embed",icon:"chart-line",edit:({attributes:e,setAttributes:r})=>{const l=(0,n.useBlockProps)(),{type:a,id:s}=e;return(0,t.createElement)(t.Fragment,null,(0,t.createElement)(n.InspectorControls,null,(0,t.createElement)(o.PanelBody,{title:"Flourish Settings"},(0,t.createElement)(o.SelectControl,{label:"Type",value:a,options:[{label:"Visualisation",value:"visualisation"},{label:"Story",value:"story"}],onChange:e=>r({type:e})}),(0,t.createElement)(o.TextControl,{label:"ID",value:s,onChange:e=>r({id:e}),placeholder:"Enter Flourish ID"}))),(0,t.createElement)("div",{...l},(0,t.createElement)(d,{block:"hm/flourish-embed",attributes:e,messages:{emptyResponse:"Please enter a Flourish ID to preview the embed."}})))},save:()=>null})})();